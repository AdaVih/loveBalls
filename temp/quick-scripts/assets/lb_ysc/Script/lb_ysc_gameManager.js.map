{"version":3,"sources":["lb_ysc_gameManager.js"],"names":["common","require","cc","Class","extends","Component","properties","id","get_star3","get_star2","account_ui","default","type","Node","back","refresh","help","h_center","level_node","schedule_bar","schedule_bar_1","schedule_bar_2","gameTip","expect","winParlicle","ScreenShotPop","onLoad","isWin","score","starCount","level","sm","levelIndex","isDraw","isStop","points","objOutP","one","director","setDisplayStats","physicsManager","getPhysicsManager","enabled","collisionManager","getCollisionManager","gm","isTip","loadRes","start","x","width","active","loader","err","prefab","starPrefab","star_lowPrefab","instantiate","naxtLevel","audioEngine","playEffect","audio_click","isHelp","index","ud","levels","length","expectPopShow","console","log","loadLevel","backLevel","isGameTb","loadScene","share","isWx","ScreenShot2","reLoad","update","dt","win","ganmeCount","overUi","lose","audio_gameover","name","tex","color","r","g","b","a","win_ui","getChildByName","img_bar","getComponent","Sprite","level_index","Label","string","starShow","i","star","pass","setUserDate","ScreenShot1","node","render","RenderTexture","create","getVisibleSize","height","_sgNode","addChild","setVisible","begin","visit","end","nowFrame","getSprite","getSpriteFrame","s_img","canvas","game","winSize","toTempFilePath","y","destWidth","destHeight","complete","res","tempFilePath","savedFilePath","txt","Math","floor","random","shareTip","wx","shareAppMessage","title","imageUrl","query","saveImg","url","fileSystemManager","getFileSystemManager","saveFile","load","img","removeSavedFile","filePath","audio_star","setTimeout","circleShow","point","p","convertToNodeSpaceAR","ads_quan","abs_anim","Animation","on","removeFromParent","getScene","tip","helpMe","tellHi"],"mappings":"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","file":"lb_ysc_gameManager.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\lb_ysc\\Script","sourcesContent":["var common = require('lb_ysc_common');\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        id:1,\r\n        get_star3:0,\r\n        get_star2:0,\r\n        account_ui: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        back: {//返回\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        refresh: {//重来\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        help: {//帮助\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        h_center: {//墨水\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        level_node:{\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        \r\n        schedule_bar:{\r\n            default:null,\r\n            type:cc.Node\r\n        },\r\n        schedule_bar_1:{\r\n            default:null,\r\n            type:cc.Node\r\n        },\r\n        schedule_bar_2:{\r\n            default:null,\r\n            type:cc.Node\r\n        },\r\n        gameTip:{\r\n            default:null,\r\n            type:cc.Node\r\n        },\r\n        expect:{\r\n            default:null,\r\n            type:cc.Node\r\n        },\r\n        winParlicle:{\r\n            default:null,\r\n            type:cc.Node\r\n        },\r\n        ScreenShotPop:{\r\n            default:null,\r\n            type:cc.Node\r\n        }\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        // common.sm.audio.play();\r\n        // common.sm.audio.setCurrentTime(common.sm.audio_time||0);\r\n        \r\n        this.isWin = false;\r\n        this.score=100,//得分\r\n        this.starCount = 1;//获得的星星\r\n        this.level = common.sm.levelIndex;//关卡索引关卡索引\r\n        this.isDraw = true;//绘制开关\r\n        this.isStop = false;//是否要停止绘制\r\n        this.points = [];//绘制的数组\r\n        this.objOutP = null;//从物体出来的点\r\n        this.one = true;\r\n        cc.director.setDisplayStats(false);\r\n        //.开启物理系统\r\n        var physicsManager = cc.director.getPhysicsManager();\r\n        physicsManager.enabled = true;\r\n        //physicsManager.debugDrawFlags = true;\r\n        // 设置绘制标志位为 0，即可以关闭绘制。\r\n        // cc.director.getPhysicsManager().debugDrawFlags = 1;\r\n\r\n        \r\n\r\n        var collisionManager = cc.director.getCollisionManager();\r\n        //开启碰撞检查系统\r\n        collisionManager.enabled = true;\r\n        common.gm = this;\r\n        \r\n        //提示开关\r\n        this.isTip = true;\r\n        //加载资源\r\n        \r\n        this.loadRes();\r\n        \r\n    },\r\n    start(){\r\n        this.schedule_bar_1.x = this.schedule_bar.width*(this.get_star3/100);\r\n        this.schedule_bar_2.x = this.schedule_bar.width*(this.get_star2/100);\r\n        this.schedule_bar_1.active = true;\r\n        this.schedule_bar_2.active = true;\r\n    },\r\n    //加载资源\r\n    loadRes(){\r\n        \r\n        //加载星星\r\n        cc.loader.loadRes(\"lb_ysc/prefab/lb_ysc_star\", (err, prefab)=> {\r\n            this.starPrefab = prefab;\r\n        });\r\n        //消散星星\r\n        cc.loader.loadRes(\"lb_ysc/prefab/lb_ysc_star_low\", (err, prefab)=> {\r\n            this.star_lowPrefab = cc.instantiate(prefab);\r\n        });\r\n    },\r\n\r\n    //下一关\r\n    naxtLevel(){\r\n        cc.audioEngine.playEffect(common.sm.audio_click, false);\r\n        if(common.sm.isHelp == false){\r\n            var index = this.level+1;\r\n            \r\n        }else{\r\n            var index = 1;\r\n            common.sm.isHelp = false;\r\n        }\r\n        if(index > common.sm.ud.levels.length){\r\n            //this.backLevel();\r\n            this.expectPopShow();\r\n        }else{\r\n            console.log(index);\r\n            common.sm.loadLevel(index);\r\n        }\r\n        \r\n        \r\n    },\r\n    //返回关卡\r\n    backLevel(){\r\n        common.sm.isGameTb = true;\r\n        common.sm.isHelp = false;\r\n        cc.director.loadScene('lb_ysc_select');\r\n        cc.audioEngine.playEffect(common.sm.audio_click, false);\r\n    },\r\n    //分享\r\n    share(){\r\n        cc.audioEngine.playEffect(common.sm.audio_click, false);\r\n        if(common.sm.isWx){\r\n            this.ScreenShot2('share');\r\n        } \r\n    }, \r\n    //重加载\r\n    reLoad(){\r\n        cc.audioEngine.playEffect(common.sm.audio_click, false);\r\n        common.sm.loadLevel(this.level);\r\n    },\r\n\r\n    // called every frame\r\n    update: function (dt) {\r\n        \r\n    }, \r\n\r\n\r\n    \r\n    //游戏胜利\r\n    win(){\r\n        console.log('you win!');\r\n        if(common.gm.isWin && common.gm.one){\r\n            common.gm.one = false;\r\n            common.gm.isDraw = false;\r\n            common.gm.ganmeCount();\r\n            this.overUi('win');\r\n            \r\n            \r\n        }\r\n    },\r\n    //失败\r\n    lose(){\r\n        common.gm.isDraw = false;\r\n        this.overUi('lose');\r\n        cc.audioEngine.playEffect(common.sm.audio_gameover, false);\r\n    },\r\n    //结束UI\r\n    overUi(name,tex){\r\n        \r\n        \r\n        //this.s_img = this.screenShoot();\r\n        this.account_ui.active = true;\r\n        this.help.active = false;//隐藏帮助按钮\r\n        this.h_center.active = false;//隐藏墨水内容\r\n        this.back.color = {r:'255',g:'255',b:'255',a:'255'};//返回按钮白色\r\n        this.refresh.color = {r:'255',g:'255',b:'255',a:'255'};//重玩按钮白色\r\n        this.win_ui = this.account_ui.getChildByName(name);\r\n        var img_bar = this.win_ui.getChildByName('img_bar').getChildByName('img').getComponent(cc.Sprite);\r\n\r\n        // if(common.sm.isWx){\r\n        //     if(this.savedFilePath){\r\n        //         img_bar.spriteFrame.setTexture(tex);\r\n        //     }\r\n        // }else{\r\n        //     img_bar.spriteFrame = this.s_img;\r\n        //     // 翻转得到的纹理\r\n        //     var action = cc.flipY(true);\r\n        //     img_bar.node.runAction(action);\r\n        // }\r\n        this.win_ui.active = true;\r\n        var level_index = this.win_ui.getChildByName('img_bar').getChildByName('level_index').getComponent(cc.Label);\r\n        var level = this.level<10?('0'+this.level):this.level;\r\n        level_index.string = level;\r\n        if(this.isWin)\r\n        {\r\n            this.starShow();\r\n            if(this.isWin && common.sm.isHelp == false){\r\n                //更新保存用户数据\r\n                var i = common.gm.level - 1;\r\n                if(common.sm.ud.levels[i].star < common.gm.starCount){\r\n                    common.sm.ud.levels[i].star = common.gm.starCount;\r\n                }\r\n                common.sm.ud.levels[i].pass = true;\r\n                if(common.sm.ud.levels[i+1]){\r\n                    common.sm.ud.levels[i+1].active = true;\r\n                }\r\n                //common.sm.ud.levels[i].img = this.savedFilePath||'';\r\n                common.sm.setUserDate(common.sm.ud);\r\n            } \r\n            // if(common.sm.isHelp){//显示炫耀按钮\r\n            //     this.win_ui.getChildByName('next').active = false;\r\n            //     this.win_ui.getChildByName('tell_hi').active = true;\r\n            // }\r\n        }\r\n        \r\n        \r\n    },\r\n    //游戏结算\r\n    ganmeCount(){\r\n        if(this.score >= this.get_star3){\r\n            this.starCount = 3;\r\n        }else if(this.score >= this.get_star2){\r\n            this.starCount = 2;\r\n        }else{\r\n            this.starCount = 1;\r\n        }\r\n    },\r\n\r\n    ScreenShot1(name){\r\n        console.log(\"========开始截屏============\");\r\n        // var level = this.node;\r\n        var level = this.node.getChildByName('environment').getChildByName('level');\r\n        //.可以把this.node从(0,0)到(width, height)截取到模拟器目录%CocosCreator%\\resources\\cocos2d-x\\simulator\\win32下的1.png。你要截全屏的话把这段代码挂在场景根节点下就可以了。\r\n        //.RenderTexture扩展的是cc.Node，你也可以setPosition去截屏幕的不同部分。\r\n        var render = new cc.RenderTexture.create(cc.director.getVisibleSize().width, cc.director.getVisibleSize().height*0.1);\r\n        level._sgNode.addChild(render);\r\n        render.setVisible(false);\r\n        render.begin();\r\n        level._sgNode.visit();\r\n        render.end();\r\n        // 获取SpriteFrame\r\n        var nowFrame = render.getSprite().getSpriteFrame();\r\n        // render.saveToFile(\"screenShot\"+this.level+\".png\",cc.ImageFormat.PNG, true, function () {\r\n        //     render.removeFromParent();\r\n        //     cc.log(\"capture screen successfully!\");\r\n        // });\r\n        //打印截图路径\r\n        // cc.log(jsb.fileUtils.getWritablePath());\r\n        //console.log(render);\r\n        this.s_img = nowFrame;\r\n        return nowFrame;\r\n    },\r\n    ScreenShot2(name){\r\n        console.log(\"========开始截屏============\");\r\n\r\n        var canvas = cc.game.canvas;\r\n        var width  = cc.winSize.width;\r\n        var height  = cc.winSize.height;\r\n        canvas.toTempFilePath({\r\n            x: 0,\r\n            y: 0,\r\n            width: width,\r\n            height: height,\r\n            destWidth: width,\r\n            destHeight: height,\r\n            complete:(res)=>{\r\n                console.log(res);\r\n                if(res.tempFilePath){\r\n                    console.log(\"缓存路径：\"+res.tempFilePath);\r\n                    this.savedFilePath = res.tempFilePath;\r\n                    \r\n                    //this.saveImg(res.tempFilePath,name);\r\n                    // cc.loader.load(res.tempFilePath, (err, tex)=>{\r\n                         //this.overUi(name,tex);                 \r\n                    // });\r\n                    if(name){\r\n                        var txt = Math.floor(Math.random()*common.shareTip.length);\r\n                        wx.shareAppMessage({\r\n                            title:common.shareTip[txt],\r\n                            imageUrl:this.savedFilePath||''\r\n                        })\r\n                        \r\n                    }else{\r\n                        //好友求助\r\n                        // var tex = new cc.Texture2D();\r\n                        // tex.initWithElement(canvas);\r\n                        // tex.handleLoadedTexture();\r\n                        // var spriteFrame = new cc.SpriteFrame(tex);\r\n                        // //var spriteFrame = this.ScreenShot1();\r\n                        // this.ScreenShotPop.getChildByName(\"img\").getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n                        // var action = cc.flipY(true);\r\n                        // this.ScreenShotPop.getChildByName(\"img\").runAction(action);\r\n                        // this.ScreenShotPop.active = true;\r\n                        // var ani = this.ScreenShotPop.getComponent(cc.Animation);\r\n                        // ani.play();\r\n                        // ani.on(\"finished\",function(){\r\n                        //     this.ScreenShotPop.active = false;\r\n                        //     wx.shareAppMessage({\r\n                        //         title:'猫咪爱情大作战，第'+common.gm.level+'关，大神帮帮ta！',\r\n                        //         imageUrl:this.savedFilePath||'',\r\n                        //         query:\"level=\"+this.level\r\n                        //     });\r\n                        // },this);\r\n                        wx.shareAppMessage({\r\n                            title:'猫咪爱情大作战，第'+common.gm.level+'关，大神帮帮ta！',\r\n                            imageUrl:this.savedFilePath||'',\r\n                            query:\"level=\"+this.level\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        \r\n        \r\n        \r\n    },\r\n    //保存截图 \r\n    saveImg(url,name){\r\n        console.log(url);\r\n        if(common.sm.isWx){\r\n            var fileSystemManager = wx.getFileSystemManager();\r\n            fileSystemManager.saveFile({\r\n                tempFilePath: url,\r\n                complete:(res)=>{\r\n                    console.log(res);\r\n                    this.savedFilePath = res.savedFilePath;\r\n                    \r\n                    if(this.savedFilePath){                       \r\n                        cc.loader.load(this.savedFilePath, (err, tex)=>{\r\n                            this.overUi(name,tex);\r\n                                             \r\n                        });\r\n                    }else{\r\n                        console.log(\"截图保存失败！\");\r\n                        cc.loader.load(url, (err, tex)=>{\r\n                            this.overUi(name,tex);                 \r\n                        });\r\n                    }\r\n                    if(this.isWin){\r\n                        //更新保存用户数据\r\n                        var i = common.gm.level - 1;\r\n                        if(common.sm.ud.levels[i].star < common.gm.starCount){\r\n                            common.sm.ud.levels[i].star = common.gm.starCount;\r\n                        }\r\n                        common.sm.ud.levels[i].pass = true;\r\n                        if(common.sm.ud.levels[i+1]){\r\n                            common.sm.ud.levels[i+1].active = true;\r\n                        }\r\n                        if(common.sm.ud.levels[i].img.length > 5){\r\n                            wx.removeSavedFile({\r\n                                filePath: common.sm.ud.levels[i].img,\r\n                                complete: (res)=> {}\r\n                            });\r\n                        };\r\n                        common.sm.ud.levels[i].img = this.savedFilePath||'';\r\n                        common.sm.setUserDate(common.sm.ud);\r\n                    } \r\n                    \r\n                }\r\n            })\r\n        }\r\n    },\r\n    \r\n\r\n\r\n    //星星显示\r\n    starShow(){\r\n        var star = cc.instantiate(this.starPrefab);\r\n        this.win_ui.getChildByName('win_star_1').addChild(star);\r\n        cc.audioEngine.playEffect(common.sm.audio_star, false);\r\n        setTimeout(()=>{\r\n            if(this.starCount >= 2){\r\n                var star = cc.instantiate(this.starPrefab);\r\n                this.win_ui.getChildByName('win_star_2').addChild(star);\r\n                cc.audioEngine.playEffect(common.sm.audio_star, false);\r\n                if(this.starCount == 3){\r\n                    setTimeout(()=>{\r\n                            var star = cc.instantiate(this.starPrefab);\r\n                            this.win_ui.getChildByName('win_star_3').addChild(star); \r\n                            cc.audioEngine.playEffect(common.sm.audio_star, false);\r\n                    },500);\r\n                }\r\n            }\r\n            \r\n        },500);\r\n    },\r\n    //显示圈圈\r\n    circleShow(point){\r\n        cc.director.getPhysicsManager().enabled = false;\r\n        if(this.isWin){\r\n            var p = this.winParlicle.convertToNodeSpaceAR(point);\r\n            this.winParlicle.x = p.x;\r\n            this.winParlicle.y = p.y;\r\n            this.winParlicle.active = true;\r\n        }\r\n        \r\n        cc.loader.loadRes(\"lb_ysc/prefab/lb_ysc_ads_quan\", (err, prefab)=> {\r\n            var ads_quan = cc.instantiate(prefab);\r\n            ads_quan.width = cc.winSize.width*2;\r\n            ads_quan.height = ads_quan.width;\r\n            ads_quan.x = point.x;\r\n            ads_quan.y = point.y;\r\n            var abs_anim = ads_quan.getComponent(cc.Animation);\r\n            abs_anim.on('finished',  function(){ads_quan.removeFromParent();\r\n                if(this.isWin){\r\n                    this.win();\r\n                }else{\r\n                    this.lose();\r\n                }\r\n            },this);\r\n            cc.director.getScene().addChild(ads_quan);\r\n        });\r\n    },\r\n    //tip\r\n    tip(){\r\n        if(common.gm.isTip){\r\n            cc.audioEngine.playEffect(common.sm.audio_click, false);\r\n            common.gm.isTip = false;\r\n            var tip = common.gm.gameTip;\r\n            if(tip){\r\n                tip.active = true;\r\n                setTimeout(()=>{\r\n                    tip.active = false;\r\n                    common.gm.isTip = true;\r\n                },500);\r\n            }else{\r\n                common.gm.isTip = true;\r\n            }\r\n            \r\n        }\r\n        \r\n    },\r\n    expectPopShow(){\r\n        this.expect.active = true;\r\n    },\r\n    //求助\r\n    helpMe(){\r\n        if(common.sm.isWx){\r\n            this.ScreenShot2();\r\n        }\r\n        \r\n    },\r\n    //告诉好友\r\n    tellHi(){\r\n        wx.shareAppMessage({\r\n            title:'猫咪爱情大作战，看看吧，这游戏应该这样玩！',\r\n            imageUrl:common.gm.savedFilePath||''\r\n        });\r\n    }\r\n\r\n\r\n\r\n\r\n});\r\n"]}